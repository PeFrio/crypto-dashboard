CODIGO CHAT GPT SITE CRYPTO

<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Crypto Dashboard</title>
  <style>
    /* (aqui mantém todo o seu CSS original, sem alterações) */
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #e0e7ff 0%, #f0f2f5 100%);
      min-height: 100vh;
      transition: background 0.3s ease, color 0.3s ease;
    }
    /* ... restante do CSS ... */
  </style>
</head>
<body>
  <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle dark mode">
    <!-- ... SVG do sol/lua ... -->
  </button>
  <div class="header">Cryptocurrency Market</div>
  <div class="dashboard-container">
    <div class="crypto-container">
      <!-- Cards serão inseridos aqui -->
      <p class="update-time">Last updated: Loading...</p>
    </div>
    <div class="right-panel">
      <div class="news-container">
        <!-- ... seu bloco de notícias ... -->
      </div>
      <div class="indicators-panel">
        <div class="fear-greed-container">
          <!-- ... Fear & Greed ... -->
        </div>
        <div class="season-container">
          <h2 class="season-title">Market Season</h2>
          <div class="season-meter">
            <div class="season-pointer" id="season-pointer"></div>
          </div>
          <div class="season-labels">
            <span class="season-btc">Bitcoin Season</span>
            <span class="season-alt">Altcoin Season</span>
          </div>
          <div class="season-value" id="season-value">--</div>
          <div class="season-description" id="season-description">Loading...</div>
          <div class="season-date" id="season-date"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // --- CONFIGURAÇÃO GERAL ---
    const API_KEY = 'SUA_CMC_PRO_API_KEY';
    const CMC_HEADERS = {
      'X-CMC_PRO_API_KEY': API_KEY,
      'Accept': 'application/json'
    };
    const cryptoConfig = {
      BTC: { name: 'Bitcoin', symbol: 'BTC', logo: 'https://s2.coinmarketcap.com/static/img/coins/64x64/1.png', id: 1 },
      ETH: { name: 'Ethereum', symbol: 'ETH', logo: 'https://s2.coinmarketcap.com/static/img/coins/64x64/1027.png', id: 1027 },
      SOL: { name: 'Solana', symbol: 'SOL', logo: 'https://s2.coinmarketcap.com/static/img/coins/64x64/5426.png', id: 5426 },
      DOGE: { name: 'Dogecoin', symbol: 'DOGE', logo: 'https://s2.coinmarketcap.com/static/img/coins/64x64/74.png', id: 74 }
    };
    let lastSuccessfulCryptoData = null, retryCount = 0, MAX_RETRIES = 3;

    // --- CRIAÇÃO DOS CARDS ---
    function createInitialCards() {
      const container = document.querySelector('.crypto-container');
      Object.values(cryptoConfig).forEach(crypto => {
        const card = document.createElement('div');
        card.className = 'crypto-card';
        card.dataset.crypto = crypto.symbol;
        card.innerHTML = `
          <div class="crypto-info">
            <div class="crypto-icon"><img src="${crypto.logo}" alt="${crypto.name}"></div>
            <div>
              <h3>${crypto.name} (${crypto.symbol})</h3>
              <p class="market-data">Loading...</p>
            </div>
          </div>
          <div>
            <div class="price">Loading...</div>
            <div class="change-positive">Loading...</div>
          </div>
          <div class="view-chart-btn" role="button" tabindex="0" data-symbol="${crypto.symbol}"></div>
        `;
        container.insertBefore(card, container.lastElementChild);
        card.querySelector('.view-chart-btn')
          .addEventListener('click', () => {
            window.open(`https://www.tradingview.com/chart/?symbol=BINANCE:${crypto.symbol}USDT&theme=dark`, '_blank');
          });
      });
    }

    // --- BUSCA DE DADOS CRYPTO ---
    async function fetchCryptoData() {
      const container = document.querySelector('.crypto-container');
      container.classList.add('loading');
      try {
        const ids = Object.values(cryptoConfig).map(c => c.id).join(',');
        const res = await fetch(
          `https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest?id=${ids}&convert=USD`,
          { headers: CMC_HEADERS }
        );
        if (!res.ok) throw new Error(`Status ${res.status}`);
        const json = await res.json();
        if (json.status.error_code !== 0) throw new Error(json.status.error_message);
        lastSuccessfulCryptoData = json.data; retryCount = 0;
        updateCryptoUI(json.data);
      } catch (err) {
        console.error('Erro fetchCryptoData:', err);
        retryCount++;
        if (lastSuccessfulCryptoData && retryCount >= MAX_RETRIES) {
          updateCryptoUI(lastSuccessfulCryptoData);
          document.querySelector('.update-time').textContent =
            `Last updated: ${new Date().toLocaleTimeString()} (cached)`;
        } else {
          document.querySelector('.update-time').textContent =
            `Erro ao atualizar. Retrying (${retryCount}/${MAX_RETRIES})...`;
        }
      } finally {
        container.classList.remove('loading');
      }
    }

    function updateCryptoUI(data) {
      document.querySelectorAll('.crypto-card').forEach(card => {
        const sym = card.dataset.crypto;
        const info = data[cryptoConfig[sym].id].quote.USD;
        const priceEl = card.querySelector('.price');
        const changeEl = card.querySelector('.change-positive, .change-negative');
        const marketEl = card.querySelector('.market-data');
        // preço
        priceEl.textContent = new Intl.NumberFormat('en-US', {
          style: 'currency', currency: 'USD',
          minimumFractionDigits: info.price < 1 ? 4 : 2,
          maximumFractionDigits: info.price < 1 ? 4 : 2
        }).format(info.price);
        // variação 24h
        changeEl.textContent = `${info.percent_change_24h.toFixed(2)}%`;
        changeEl.className = info.percent_change_24h >= 0 ? 'change-positive' : 'change-negative';
        // market cap & volume
        marketEl.textContent =
          `Market Cap: $${(info.market_cap/1e9).toFixed(1)}B | 24h Vol: $${(info.volume_24h/1e9).toFixed(1)}B`;
      });
      document.querySelector('.update-time').textContent =
        `Last updated: ${new Date().toLocaleTimeString()}`;
    }

    // --- FEAR & GREED INDEX ---
    async function fetchFearGreedIndex() {
      try {
        const res = await fetch('https://api.alternative.me/fng/');
        const json = await res.json();
        const idx = json.data[0];
        const v = parseInt(idx.value);
        document.getElementById('fear-greed-value').textContent = v;
        document.getElementById('fear-greed-label').textContent = idx.value_classification;
        const date = new Date(idx.timestamp*1000);
        document.getElementById('fear-greed-date').textContent =
          `Last updated: ${date.toLocaleDateString()} ${date.toLocaleTimeString()}`;
        document.getElementById('meter-pointer').style.left = `${v}%`;
        document.getElementById('fear-greed-value').style.color =
          v <= 20 ? '#e84142' : v <= 40 ? '#ffa500' : v <= 60 ? '#ffff00' : v <= 80 ? '#90ee90' : '#008000';
      } catch (e) {
        console.error('Erro F&G:', e);
        document.getElementById('fear-greed-description').textContent = 'Error loading data';
      }
    }

    // --- MARKET SEASON (ALTCOIN SEASON) ---
    async function fetchSeasonIndex() {
      try {
        const res = await fetch(
          'https://pro-api.coinmarketcap.com/v1/global-metrics/quotes/latest',
          { headers: CMC_HEADERS }
        );
        if (!res.ok) throw new Error(`Status ${res.status}`);
        const json = await res.json();
        const btcDom = json.data.btc_dominance;         // % de dominância do BTC
        const seasonValue = Math.round(100 - btcDom);
        // Atualiza UI
        document.getElementById('season-value').textContent = `${seasonValue}%`;
        document.getElementById('season-description').textContent =
          seasonValue >= 75
            ? "É Altcoin Season! A maioria dos altcoins supera o Bitcoin."
            : seasonValue <= 25
            ? "É Bitcoin Season! Bitcoin domina o mercado."
            : "Mixed Season – equilíbrio entre Bitcoin e Altcoins.";
        document.getElementById('season-pointer').style.left = `${seasonValue}%`;
        const now = new Date();
        document.getElementById('season-date').textContent =
          `Last updated: ${now.toLocaleDateString()} ${now.toLocaleTimeString()}`;
      } catch (err) {
        console.error('Erro Season Index:', err);
        document.getElementById('season-value').textContent = '--';
        document.getElementById('season-description').textContent = 'Indisponível no momento.';
      }
    }

    // --- (Opcional) Histórico de Altcoin Season ---
    async function fetchSeasonHistory(days = 30) {
      const endTs = Math.floor(Date.now()/1000);
      const startTs = endTs - days*24*3600;
      try {
        const res = await fetch(
          `https://pro-api.coinmarketcap.com/v1/global-metrics/quotes/historical` +
          `?time_start=${startTs}&time_end=${endTs}&interval=daily`,
          { headers: CMC_HEADERS }
        );
        const json = await res.json();
        return json.data.map(pt => ({
          date: new Date(pt.timestamp*1000),
          value: 100 - pt.btc_dominance
        }));
      } catch (err) {
        console.error('Erro histórico Season:', err);
        return [];
      }
    }

    // --- THEME TOGGLE E LOCALSTORAGE ---
    function toggleTheme() {
      const body = document.body;
      const dark = body.classList.toggle('dark-mode');
      const btn = document.querySelector('.theme-toggle');
      btn.innerHTML = dark
        ? `<svg><!-- lua --></svg>`
        : `<svg><!-- sol --></svg>`;
      localStorage.setItem('darkMode', dark);
    }
    document.addEventListener('DOMContentLoaded', () => {
      if (localStorage.getItem('darkMode') === 'true') {
        document.body.classList.add('dark-mode');
        document.querySelector('.theme-toggle').innerHTML = `<svg><!-- lua --></svg>`;
      }
    });

    // --- INICIALIZAÇÃO E INTERVALOS ---
    document.addEventListener('DOMContentLoaded', () => {
      createInitialCards();
      fetchCryptoData();
      fetchNews();
      fetchFearGreedIndex();
      fetchSeasonIndex();
      // se quiser usar histórico: fetchSeasonHistory().then(console.log);
    });
    setInterval(fetchCryptoData, 60_000);
    setInterval(fetchNews, 30*60_000);
    setInterval(fetchFearGreedIndex, 15*60_000);
    setInterval(fetchSeasonIndex, 15*60_000);
    setInterval(() => {
      if (retryCount >= MAX_RETRIES) {
        retryCount = 0;
        fetchCryptoData();
      }
    }, 5*60_000);

    // --- FUNÇÃO fetchNews (mantida sem proxy) ---
    async function fetchNews() {
      const btn = document.querySelector('.refresh-button');
      btn.disabled = true; btn.style.opacity = '0.7';
      const feed = document.getElementById('news-feed');
      feed.innerHTML = `<div class="news-item"><p>Loading news...</p></div>`;
      try {
        const res = await fetch('https://min-api.cryptocompare.com/data/v2/news/?lang=EN&api_key=SEU_API_KEY');
        const json = await res.json();
        if (json.Data && json.Data.length) {
          feed.innerHTML = json.Data.slice(0,10).map(n => `
            <div class="news-item">
              <a href="${n.url}" target="_blank" class="news-title">${n.title}</a>
              <div class="news-meta">
                <span class="news-source">${n.source}</span>
                <span class="news-date">${new Date(n.published_on*1000).toLocaleString()}</span>
              </div>
            </div>
          `).join('');
        } else {
          feed.innerHTML = `<div class="news-item"><p>No news available.</p></div>`;
        }
      } catch (e) {
        console.error('Erro news:', e);
        feed.innerHTML = `<div class="news-item"><p>Error loading news.</p></div>`;
      } finally {
        btn.disabled = false; btn.style.opacity = '1';
      }
    }
  </script>
</body>
</html>
